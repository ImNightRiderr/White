@echo off
title Jqe3G62h554
goto CheckPermissions

:CheckPermissions
net session >nul 2>&1
if %errorLevel% == 0 (
goto PermissionsFound
) else (
goto PermissionsNotFound
)

:PermissionsFound
mkdir %homepath%\Documents\Temp
goto menu
:PermissionsNotFound
echo [37mError! Please run this file as administrator.
ping localhost -n 3 >nul
exit





echo [94mJournal Paths
echo [36m[JSC] [37mSecurity change //
echo [36m[JER] [37mExplorer restart
echo [36m[JDF] [37mDeleted files //
echo [36m[JRF] [37mRenamed files
echo [36m[JFS] [37mFile streams
echo [36m[JFT] [37mType
echo [36m[JJC] [37mjarcache
echo.
echo [94mMacro Paths
echo [36m[L1] [37mLogitech Gaming Software
echo [36m[L2] [37mLGHUB
echo [36m[R1] [37mRazer
echo [36m[R2] [37mRazer
echo [36m[CO] [37mCorsair
echo [36m[MO] [37mGlorious Model O
echo [36m[F5] [37mAukey
echo.
echo [94mRegistry Paths
echo [36m[EF] [37mExecutable files ran
echo [36m[EP] [37mExecuted programs
echo [36m[FA] [37mFile type associations
echo [36m[OS] [37mFiles opened with Open/Save dialog-box
echo [36m[MV] [37mMounted volumes
echo [36m[PF] [37mPrefetch parameters
echo.
echo [94mEvent Viewer
echo [36m[TC] [37mCheck for Time change
echo [36m[LC] [37mCheck for Logs clear 
echo [36m[AJ] [37mCheck Applications logs for deleted journal
echo [36m[NJ] [37mCheck Ntfs logs for deleted journal
echo [36m[NS] [37mCheck if Ntfs logs are enabled
echo.
echo Write [36m[Quit] [37mto destruct
echo Write [36m[Record] [37mto check if there's any recording software running
echo.
set /p M="[36mPlease, choose[37m: "

:: Manual tools

if %M%==1 goto ProcessHacker2
if %M%==2 goto LastActivityView
if %M%==3 goto WinPrefetchView
if %M%==4 goto Luyten
if %M%==5 goto Everything
if %M%==6 goto AlternateStreamView
if %M%==7 goto PreviousFilesRecovery
if %M%==8 goto RegScanner
if %M%==9 goto USBDeview

:: Automatic tools

if %M%==AV goto Avenge
if %M%==PA goto Paladin
if %M%==SM goto SMT

:: USN journal paths

if %M%==JDF goto journalDeletedFiles
if %M%==JRF goto journalRenamedFiles
if %M%==JFT goto journalFileType
if %M%==JFS goto journalFileStream
if %M%==JER goto journalExplorerRestart
if %M%==JJC goto journalJarcache
if %M%==JSC goto journalSecurityChanges

:: Macro paths

if %M%==L1 goto LogitechGamingSoftware
if %M%==L2 goto LGHUB
if %M%==R1 goto ProgramRazer
if %M%==R2 goto LocalRazer
if %M%==CO goto Corsair
if %M%==MO goto GloriousModelO
if %M%==F5 goto Aukey

:: regedit paths

if %M%==EF goto ExecutableFilesRan
if %M%==EP goto ExecutedPrograms
if %M%==FA goto FileTypeAssociations
if %M%==OS goto OpenSaveDialogBox
if %M%==PF goto PrefetchParameters
if %M%==MV goto MountedVolumes

:: Event Viewer checks

if %M%==TC goto TimeChange
if %M%==LC goto LogClear
if %M%==AJ goto ApplicationsJournal
if %M%==NJ goto NtfsJournal
if %M%==NS goto NtfsLogsState

:: Destruct

if %M%==Quit goto Destruct
if %M%==Record goto RecordingSoftwares

echo %M% isn't a valid code, try again
ping localhost -n 2 >nul
goto menu





:: Download tools

:ProcessHacker2
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://github.com/processhacker/processhacker/releases/download/v2.39/processhacker-2.39-setup.exe','%homepath%\Documents\Temp\ProcessHacker2 Setup.exe')
"%homepath%\Documents\Temp\ProcessHacker2 Setup.exe"
goto menu
:LastActivityView
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://www.nirsoft.net/utils/lastactivityview.zip','%homepath%\Documents\Temp\LastActivityView.zip')
"%homepath%\Documents\Temp\LastActivityView.zip"
goto menu
:WinPrefetchView
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://www.nirsoft.net/utils/winprefetchview-x64.zip','%homepath%\Documents\Temp\WinPrefetchView.zip')
"%homepath%\Documents\Temp\WinPrefetchView.zip"
goto menu
:Luyten
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://github.com/deathmarine/Luyten/releases/download/v0.5.4_Rebuilt_with_Latest_depenencies/luyten-0.5.4.exe','%homepath%\Documents\Temp\Luyten.exe')
"%homepath%\Documents\Temp\Luyten.exe"
goto menu
:Everything
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://www.voidtools.com/Everything-1.4.1.1005.x64.zip','%homepath%\Documents\Temp\Everything.zip')
"%homepath%\Documents\Temp\Everything.zip"
goto menu
:AlternateStreamView
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://www.nirsoft.net/utils/alternatestreamview-x64.zip','%homepath%\Documents\Temp\AlternateStreamView.zip')
"%homepath%\Documents\Temp\AlternateStreamView.zip"
goto menu
:PreviousFilesRecovery
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://www.nirsoft.net/utils/previousfilesrecovery-x64.zip','%homepath%\Documents\Temp\PreviousFilesRecovery.zip')
"%homepath%\Documents\Temp\PreviousFilesRecovery.zip"
goto menu
:RegScanner
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://www.nirsoft.net/utils/regscanner-x64.zip','%homepath%\Documents\Temp\RegScanner.zip')
"%homepath%\Documents\Temp\RegScanner.zip"
goto menu
:USBDeview
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://www.nirsoft.net/utils/usbdeview-x64.zip','%homepath%\Documents\Temp\USBDeview.zip')
"%homepath%\Documents\Temp\USBDeview.zip"
goto menu
:Avenge
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://avenge.ac/download','%homepath%\Documents\Temp\Avenge.exe')
"%homepath%\Documents\Temp\Avenge.exe"
goto menu
:Paladin
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://dl.paladin.ac/','%homepath%\Documents\Temp\Paladin.exe')
"%homepath%\Documents\Temp\Paladin.exe"
goto menu
:SMT
cls
powershell (new-object System.Net.WebClient).DownloadFile('https://cdn.discordapp.com/attachments/832255116051742763/832256347197800509/SMT.exe','%homepath%\Documents\Temp\SMT.exe')
"%homepath%\Documents\Temp\SMT.exe"
goto menu





:: USN journal paths

:journalDeletedFiles
cls
fsutil usn readjournal c: csv | findstr /i /C:"0x80000200" | findstr /i /C:.exe\^" /i /C:.py\^" /i /C:.jar\^" /i /C:.dll\^" /i /C:.com\^" /i /C:.pif\^" /i /C:.txt\^" /i /C:.jpg\^" /i /C:.jpeg\^" /i /C:.png\^" /i /C:.lnk\^" /i /C:.mp3\^" /i /C:.mp4\^" /i /C:.mkv\^" /i /C:.avi\^" /i /C:.ico\^" /i /C:.bat\^" /i /C:.cmd\^" /i /C:.reg\^" /i /C:.zip\^" /i /C:.rar\^" /i /C:.7z\^" /i /C:.ini\^" /i /C:.html\^" /i /C:.ppt\^" /i /C:.docx\^" /i /C:.xlsx\^" /i /C:.chm\^" /i /C:.aspx\^" /i /C:.app\^" /i /C:? > %homepath%\Documents\Temp\deletedfiles.txt
"%homepath%\Documents\Temp\deletedfiles.txt"
goto menu
:journalRenamedFiles
cls
fsutil usn readjournal c: csv | findstr /i /C:"0x00002000" /i /C:"0x00001000" | findstr /i /C:.exe\^" /i /C:.py\^" /i /C:.jar\^" /i /C:.dll\^" /i /C:.com\^" /i /C:.pif\^" /i /C:.txt\^" /i /C:.jpg\^" /i /C:.jpeg\^" /i /C:.png\^" /i /C:.lnk\^" /i /C:.mp3\^" /i /C:.mp4\^" /i /C:.mkv\^" /i /C:.avi\^" /i /C:.ico\^" /i /C:.bat\^" /i /C:.cmd\^" /i /C:.reg\^" /i /C:.zip\^" /i /C:.rar\^" /i /C:.7z\^" /i /C:.ini\^" /i /C:.html\^" /i /C:.ppt\^" /i /C:.docx\^" /i /C:.xlsx\^" /i /C:.chm\^" /i /C:.aspx\^" /i /C:.app\^" /i /C:? > %homepath%\Documents\Temp\renamedfiles.txt
"%homepath%\Documents\Temp\renamedfiles.txt"
goto menu
:journalFileType
cls
fsutil usn readJournal c: csv | findstr /i /C:"0x00002020" /i /C:"0x00000020" /i /C:"0x00200000" | findstr /i /C:"0x80008000" /i /C:"0x00008006" /i /C:"0x80200120" | findstr /i /C:.exe\^" /i /C:.py\^" /i /C:.jar\^" /i /C:.dll\^" /i /C:.com\^" /i /C:.pif\^" /i /C:.txt\^" /i /C:.jpg\^" /i /C:.jpeg\^" /i /C:.png\^" /i /C:.lnk\^" /i /C:.mp3\^" /i /C:.mp4\^" /i /C:.mkv\^" /i /C:.avi\^" /i /C:.ico\^" /i /C:.bat\^" /i /C:.cmd\^" /i /C:.reg\^" /i /C:.zip\^" /i /C:.rar\^" /i /C:.7z\^" /i /C:.ini\^" /i /C:.html\^" /i /C:.ppt\^" /i /C:.docx\^" /i /C:.xlsx\^" /i /C:.chm\^" /i /C:.aspx\^" /i /C:.app\^" /i /C:? > %homepath%\Documents\Temp\type.txt
"%homepath%\Documents\Temp\type.txt"
goto menu
:journalFileStream
cls
fsutil usn readJournal c: csv | findstr /I /C:"0x00200120" > %homepath%\Documents\Temp\streams.txt
"%homepath%\Documents\Temp\streams.txt"
goto menu
:journalExplorerRestart
cls
fsutil usn readJournal c: csv | findstr /i /C:0x00000100 | findstr /i /C:explorer | findstr /i /C:.pf\^" > %homepath%\Documents\Temp\restartexplorer.txt
"%homepath%\Documents\Temp\restartexplorer.txt"
goto menu
:journalJarcache
cls
fsutil usn readJournal c: csv | findstr /i /C:"0x00000004" /i /C:"0x00000102" | findstr /i /C:"jar_cache" /i /C:".timestamp" > %homepath%\Documents\Temp\jarcache.txt
"%homepath%\Documents\Temp\jarcache.txt"
goto menu
:journalSecurityChanges
cls
fsutil usn readjournal c: csv | findstr /i /C:"0x00000800" | findstr /i /C:.exe\^" /i /C:Prefetch > %homepath%\Documents\Temp\securitychanges.txt
"%homepath%\Documents\Temp\securitychanges.txt"
goto menu





:: Macro paths

:LogitechGamingSoftware
cls
if exist "%localappdata%\Logitech\Logitech Gaming Software" (
goto LogitechGamingSoftwareFound
) else (
goto NotFound
)
:LGHUB
cls
if exist "%localappdata%\LGHUB" (
goto LGHUBFound
) else (
goto NotFound
)
:ProgramRazer
cls
if exist "%programdata%\Razer\Synapse\Accounts" (
goto ProgramRazerFound
) else (
goto NotFound
)
:LocalRazer
cls
if exist "%localappdata%\Razer\Synapse3\Settings" (
goto LocalRazerFound
) else (
goto NotFound
)
:Corsair
cls
if exist "%appdata%\Corsair\Cue" (
goto CorsairFound
) else (
goto NotFound
)
:GloriousModelO
cls
if exist "%localappdata%\BY-COMBO2" (
goto GloriousModelOFound
) else (
goto NotFound
)
:Aukey
cls
if exist "%localappdata%\JM01" (
goto AukeyFound
) else (
goto NotFound
)





:: regedit paths

:ExecutableFilesRan
cls
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\Regedit /v LastKey /t REG_SZ /d HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\bam\State\UserSettings /f
start regedit
echo Done
goto menu
:FileTypeAssociations
cls
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\Regedit /v LastKey /t REG_SZ /d HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts /f
start regedit
echo Done
goto menu
:OpenSaveDialogBox
cls
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\Regedit /v LastKey /t REG_SZ /d HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU /f
start regedit
echo Done
goto menu
:PrefetchParameters
cls
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\Regedit /v LastKey /t REG_SZ /d "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\PrefetchParameters" /f
start regedit
echo Done
goto menu
:MountedVolumes
cls
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\Regedit /v LastKey /t REG_SZ /d HKEY_LOCAL_MACHINE\SYSTEM\MountedDevices /f
start regedit
echo Done
goto menu
:ExecutedPrograms
cls
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\Regedit /v LastKey /t REG_SZ /d "HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant\Store" /f
start regedit
echo Done
goto menu





:: Event Viewer

:TimeChange
cls
powershell Get-EventLog -LogName Security -InstanceId 4616
echo [37mPress [36mENTER [37mto return to the menu
pause >nul
goto menu
:LogClear
cls
powershell Get-EventLog -LogName Security -InstanceId 1102
echo [37mPress [36mENTER [37mto return to the menu
pause >nul
goto menu
:ApplicationsJournal
cls
powershell Get-EventLog -LogName Application -InstanceId 3079
echo [37mPress [36mENTER [37mto return to the menu
pause >nul
goto menu
:NtfsJournal
cls
powershell Get-WinEvent Microsoft-Windows-Ntfs/Operational | findstr 501
echo [37mPress [36mENTER [37mto return to the menu
pause >nul
goto menu
:NtfsLogsState
cls
powershell "Get-WinEvent -ListLog Microsoft-Windows-Ntfs/Operational | Format-List *" | findstr IsEnabled
echo [37mPress [36mENTER [37mto return to the menu
pause >nul
goto menu





:: Recording softwares check

:RecordingSoftwares
cls
tasklist | findstr /i /C:obs32.exe /i /C:obs64.exe /i /C:bdcam.exe /i /C:Action.exe /i /C:action_svc.exe /i /C:XSplit.Core.exe /i /C:RadeonSettings.exe /i /C:ShareX.exe /i /C:"NVIDIA Share.exe" /i /C:CamRecorder.exe /i /C:Fraps.exe 
if %errorLevel% == 0 (
goto RecordingSoftwareFound
) else (
goto NotFound
)
goto menu
:RecordingSoftwareFound
cls
echo [37mA recording software was found! Please, investigate.
ping localhost -n 4 >nul
goto menu





:: Destruct

:Destruct
cls
rmdir /s /q %homepath%\Documents\Temp
"C:\Program Files\Process Hacker 2\unins000.exe"
del %0
exit





:: Macro stuff

:LogitechGamingSoftwareFound
explorer "%localappdata%\Logitech\Logitech Gaming Software\profiles"
goto menu
:LGHUBFound
explorer "%localappdata%\LGHUB"
goto menu
:ProgramRazerFound
explorer "%programdata%\Razer\Synapse\Accounts"
goto menu
:LocalRazerFound
explorer "%localappdata%\Razer\Synapse3\Settings"
goto menu
:CorsairFound
explorer "%appdata%\Corsair\Cue"
goto menu
:GloriousModelOFound
explorer "%localappdata%\BY-COMBO2"
goto menu
:AukeyFound
explorer "%localappdata%\JM01"
goto menu
:NotFound
cls
echo [37mNothing found.
ping localhost -n 4 >nul
goto menu